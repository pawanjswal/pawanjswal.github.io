# Mara CMS Exploit for File Upload Vulnerability | CVE-2020-25042
![CVE-2020-25042](https://raw.githubusercontent.com/pawanjswal/pawanjswal.github.io/master/cve-2020-25042/assets/thumbnail.jpg)

# TL;DR
An arbitrary file upload vulnerability has been found in Mara CMS version 7.5. This security issue requires an attacker to have a valid authenticated session as an admin or manager. The attacker can exploit this by making a request to 'codebase/dir.php?type=filenew' allowing them to upload malicious PHP code to 'codebase/handler.php'.

# Disclaimer
This project is intended for educational purposes and ethical hacking. Do not use OpenExploit on networks or systems without explicit permission. Unauthorized use of OpenExploit may violate laws and result in serious consequences.

# About Mara CMS
An arbitrary file upload vulnerability has been identified in Mara CMS version 7.5. This security issue requires an attacker to have a valid authenticated session as an admin or manager. To exploit the vulnerability, the attacker needs to make a specific request to `codebase/dir.php?type=filenew` which allows the upload of PHP code to `codebase/handler.php`. This vulnerability can be leveraged to execute arbitrary code on the affected system.

# Mitigation
1. Update to the latest version of Mara CMS, as the issue may have been addressed in newer releases.
2. Restrict permissions for authenticated users, ensuring that only trusted administrators and managers have access to the functionality allowing file uploads.
3. Implement file type whitelisting to ensure that only safe file types, such as images or documents, can be uploaded through codebase/dir.php?type=filenew.
4. Perform server-side validation on uploaded files to check for malicious content or file extensions disguised as safe ones.
5. Regularly review and audit the codebase, particularly codebase/handler.php, for any vulnerabilities or unusual activities.
6. Enable logging and monitoring of file upload activities to detect and respond to any unauthorized or suspicious actions

# Exploit Scenario
An attacker who has gained valid administrative or managerial credentials for Mara CMS version 7.5 can exploit the arbitrary file upload vulnerability by making a specific HTTP request. The attacker sends a request to "codebase/dir.php?type=filenew" which allows them to upload malicious PHP code to the server. This malicious code is uploaded to "codebase/handler.php" where it can be executed, potentially giving the attacker further access to the system or the ability to perform unauthorized actions.

# DockerHub Link
To try out a demo environment for , you can visit our DockerHub repository https://hub.docker.com/r/pawanjswal/cve-2020-25042. Also checkout some of other CVE's here https://hub.docker.com/u/pawanjswal

# Video Tutorial
Video tutorials for exploiting  and securing Mara CMS installations is available https://www.youtube.com/watch?v=cve-2020-25042. Also, checkout other vidos here https://www.youtube.com/@OpenExploit

# About OpenExploit
**OpenExploit** is an educational platform designed for security enthusiasts to explore, learn, and share knowledge about Common Vulnerabilities and Exposures (CVEs). It aims to demystify how CVEs function, what constitutes a vulnerability, and the best practices for ethical hacking. By providing resources, tutorials, and a community-driven approach, OpenExploit encourages hands-on learning through practical experience, including tools and techniques for vulnerability assessment and penetration testing. It's a space for collaboration, exploration, and advancement in the field of cybersecurity.