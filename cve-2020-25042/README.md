# Mara CMS Exploit for File Upload Vulnerability | CVE-2020-25042
![CVE-2020-25042](https://raw.githubusercontent.com/pawanjswal/pawanjswal.github.io/master/cve-2020-25042/assets/thumbnail.jpg)

# TL;DR
An arbitrary file upload vulnerability in Mara CMS 7.5 allows attackers with authenticated admin or manager sessions to upload PHP code. This is achieved by making a request to codebase/dir.php?type=filenew, which subsequently uploads the PHP code to codebase/handler.php. This vulnerability could potentially be exploited to execute arbitrary code on the server.

# Disclaimer
This project is intended for educational purposes and ethical hacking. Do not use OpenExploit on networks or systems without explicit permission. Unauthorized use of OpenExploit may violate laws and result in serious consequences.

# About Mara CMS
An arbitrary file upload issue has been identified in Mara CMS version 7.5. To exploit this vulnerability, an attacker needs to have a valid authenticated session as an admin or manager. The attacker can then make a request to codebase/dir.php with the parameter "type=filenew" to upload PHP code to codebase/handler.php.

# Mitigation
1. Enforce authentication and authorization: Ensure that user roles and permissions are correctly set up and restrict the ability for admin and manager roles to upload code files, if not necessary for their duties.
2. Input validation: Implement strict input validation on file uploads to restrict allowable file extensions to only those that are necessary for business purposes, disallowing files with potentially harmful code such as PHP files.
3. Content-type verification: Verify the MIME content-type of uploaded files to ensure that they match expected file types and are not executable files disguised with changed extensions.
4. File upload location: Change the file upload location to a directory outside of the web root and do not allow direct execution of files from the upload directory.
5. Regular audits: Conduct regular

# Exploit Scenario
An attacker with a valid authenticated session as an admin or manager in Mara CMS 7.5 can exploit the arbitrary file upload vulnerability by sending a request to 'codebase/dir.php?type=filenew'. This allows the attacker to upload malicious PHP code to 'codebase/handler.php'. Once uploaded, the PHP code can be executed to perform unauthorized actions on the web server, potentially leading to further compromise of the system.

# DockerHub Link
To try out a demo environment for CVE-2020-25042, you can visit our DockerHub repository here [![Docker Hub](https://img.shields.io/badge/Docker_Hub-2496ED?style=flat-square&logo=docker&logoColor=white)](https://hub.docker.com/r/pawanjswal/cve-2020-25042).

Checkout some of other CVE images on [![Docker Hub](https://img.shields.io/badge/Docker_Hub-2496ED?style=flat-square&logo=docker&logoColor=white)](https://hub.docker.com/u/pawanjswal)

# Video Tutorial
Video tutorials for exploiting CVE-2020-25042 and securing Mara CMS installations is available here [![YouTube](https://img.shields.io/badge/YouTube-FF0000?style=flat-square&logo=youtube&logoColor=white)](https://www.youtube.com/watch?v=cve-2020-25042). 

Checkout our other videos on [![YouTube](https://img.shields.io/badge/YouTube-FF0000?style=flat-square&logo=youtube&logoColor=white)](https://www.youtube.com/@OpenExploit)

# About OpenExploit
![OpenExploit](https://raw.githubusercontent.com/pawanjswal/pawanjswal.github.io/refs/heads/master/assets/logo.png)

**OpenExploit** is an educational platform designed for security enthusiasts to explore, learn, and share knowledge about Common Vulnerabilities and Exposures (CVEs). It aims to demystify how CVEs function, what constitutes a vulnerability, and the best practices for ethical hacking. By providing resources, tutorials, and a community-driven approach, OpenExploit encourages hands-on learning through practical experience, including tools and techniques for vulnerability assessment and penetration testing. It's a space for collaboration, exploration, and advancement in the field of cybersecurity.